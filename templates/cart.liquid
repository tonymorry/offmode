
<section class="py-24 px-6 min-h-[70vh] bg-[var(--bg-cream)]">
  <div class="max-w-4xl mx-auto">
    <header class="mb-16 text-center">
      <h1 class="serif text-5xl md:text-6xl text-[#1a1a1a] mb-4">Il tuo Carrello</h1>
      <div class="h-px bg-[#e5e1d8] w-24 mx-auto"></div>
    </header>

    {% if cart.item_count > 0 %}
      <form action="{{ routes.cart_url }}" method="post" novalidate class="bg-white border border-[#e5e1d8] p-8 md:p-12 vintage-shadow">
        <div class="space-y-10">
          {% for item in cart.items %}
            <div class="flex flex-col md:flex-row items-start md:items-center gap-8 pb-10 border-b border-[#f0ede4] last:border-0 last:pb-0">
              <!-- Immagine Prodotto -->
              <div class="w-24 h-24 bg-[#f9f7f2] border border-[#e5e1d8] flex-shrink-0">
                {% if item.image %}
                  <img src="{{ item.image | img_url: '2400x' }}" alt="{{ item.title | escape }}" class="w-full h-full object-contain mix-blend-multiply">
                {% else %}
                  {{ 'product-1' | placeholder_svg_tag: 'w-full h-full object-contain opacity-20' }}
                {% endif %}
              </div>

              <!-- Dettagli Prodotto -->
              <div class="flex-grow space-y-2">
                <h3 class="serif text-2xl text-[#1a1a1a] leading-tight">
                  <a href="{{ item.url }}" class="hover:opacity-70 transition-opacity">{{ item.product.title }}</a>
                </h3>
                {% unless item.product.has_only_default_variant %}
                  <p class="text-[10px] font-bold uppercase tracking-widest text-gray-400">{{ item.variant.title }}</p>
                {% endunless %}
                <p class="text-sm font-medium text-[#1a1a1a]">{{ item.final_price | money }}</p>
              </div>

              <!-- Quantità e Azioni -->
              <div class="flex items-center gap-8 w-full md:w-auto justify-between md:justify-end">
                <div class="flex items-center border border-[#e5e1d8] bg-[#f9f7f2]">
                  <label for="updates_{{ item.key }}" class="sr-only">Quantità</label>
                  <input 
                    type="number" 
                    name="updates[]" 
                    id="updates_{{ item.key }}" 
                    value="{{ item.quantity }}" 
                    min="0" 
                    class="w-16 text-center py-2 text-xs font-bold bg-transparent outline-none focus:bg-white transition-colors"
                  >
                </div>
                
                <div class="text-right">
                  <p class="text-sm font-bold text-[#1a1a1a] mb-2">{{ item.final_line_price | money }}</p>
                  <a href="{{ item.url_to_remove }}" class="text-[9px] font-black uppercase tracking-[0.2em] text-red-700 hover:text-red-500 transition-colors">
                    Rimuovi
                  </a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>

        <!-- Riepilogo e Checkout -->
        <footer class="mt-16 pt-10 border-t border-[#e5e1d8] flex flex-col md:flex-row items-center justify-between gap-8">
          <div class="text-center md:text-left">
            <p class="text-[10px] font-bold uppercase tracking-[0.3em] text-gray-400 mb-2">Totale Parziale</p>
            <h2 class="text-4xl font-medium text-[#1a1a1a]">{{ cart.total_price | money }}</h2>
            <p class="text-[10px] text-gray-400 italic mt-2 tracking-wide">Tasse e spedizione calcolate al checkout</p>
          </div>

          <div class="flex flex-col sm:flex-row gap-4 w-full md:w-auto">
            <button type="submit" name="update" class="px-8 py-4 border border-black text-[10px] font-bold uppercase tracking-[0.2em] hover:bg-[#f9f7f2] transition-colors">
              Aggiorna
            </button>
            <button type="submit" name="checkout" class="px-12 py-4 bg-black text-white text-[10px] font-bold uppercase tracking-[0.3em] hover:bg-zinc-800 transition-all shadow-xl">
              Procedi al Checkout
            </button>
          </div>
        </footer>
      </form>
    {% else %}
      <!-- Carrello Vuoto -->
      <div class="text-center py-20 bg-white border border-[#e5e1d8] px-8 vintage-shadow">
        <div class="mb-10 opacity-10">
          <svg class="w-24 h-24 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
          </svg>
        </div>
        <h2 class="serif text-3xl mb-6 text-[#1a1a1a]">Il tuo carrello è vuoto.</h2>
        <p class="text-gray-500 mb-12 max-w-sm mx-auto font-light leading-relaxed">
          Sembra che tu non abbia ancora scelto la tua colonna sonora per il digital detox. Ritorna all'essenziale.
        </p>
        <a href="{{ routes.root_url }}" class="inline-block bg-black text-white px-12 py-5 text-[10px] font-bold uppercase tracking-[0.3em] hover:bg-zinc-800 transition-all">
          Torna allo Store
        </a>
      </div>
    {% endif %}
  </div>
</section>
